/* from page 62 of the C manual */
#include <stdio.h>

void shellsort(int v[], int n);
void myshellsort(int v[], int n);

int main()
{
  int array[] = { 190, 74, 275, 70, 83, 4, 278, 399, 137, 75, 333, 214, 188, 125, 297, 128, 384, 149, 272, 24, 333, 41, 89, 213, 7, 28, 36, 143, 353, 323, 333, 164, 94, 280, 70, 154, 363, 207, 39, 244, 156, 287, 8, 259, 22, 77, 215, 217, 222, 152, 11, 337, 345, 231, 48, 336, 188, 351, 244, 300, 66, 291, 370, 10, 31, 258, 275, 220, 105, 18, 78, 390, 36, 121, 321, 173, 231, 369, 222, 394, 236, 396, 70, 266, 217, 189, 109, 269, 287, 349, 326, 344, 201, 0, 165, 179, 210, 230, 300, 93 };
  int duplicate[] = { 190, 74, 275, 70, 83, 4, 278, 399, 137, 75, 333, 214, 188, 125, 297, 128, 384, 149, 272, 24, 333, 41, 89, 213, 7, 28, 36, 143, 353, 323, 333, 164, 94, 280, 70, 154, 363, 207, 39, 244, 156, 287, 8, 259, 22, 77, 215, 217, 222, 152, 11, 337, 345, 231, 48, 336, 188, 351, 244, 300, 66, 291, 370, 10, 31, 258, 275, 220, 105, 18, 78, 390, 36, 121, 321, 173, 231, 369, 222, 394, 236, 396, 70, 266, 217, 189, 109, 269, 287, 349, 326, 344, 201, 0, 165, 179, 210, 230, 300, 93 };

  shellsort(array, 100);
  myshellsort(duplicate, 100);

  for (int i = 0; i < 100; i++)
  {
    printf("%d\t", array[i] == duplicate[i]);
  }
  return 0;
}

void shellsort(int v[], int n)
{
  int gap, i, j, temp, swaps = 0;

  for(gap = n/2; gap > 0; gap /=2){
    for (i = gap; i < n; i++){
      for (j = i-gap; j >= 0 && v[j] > v[j+gap]; j -= gap){
        swaps++;
        temp = v[j], v[j] = v[j+gap], v[j+gap] = temp;
      }
    }
  }
  printf("%d\n", swaps);
}

void myshellsort(int v[], int n)
{
  int gap, i, j, temp, swaps = 0;

  for(gap = n/2; gap > 0; gap /= 2){
    for (i = gap; i < n; i++){
      for (j = i-gap; j >= 0; j -= gap){
        if(v[j] > v[j+gap]) {
          swaps++;
          temp = v[j], v[j] = v[j+gap], v[j+gap] = temp;
        }
      }
    }
  }
  printf("%d\n", swaps);
}
